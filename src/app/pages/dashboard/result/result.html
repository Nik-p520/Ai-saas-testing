<div class="min-h-screen">
  <!-- Header -->
  <div class="border-b border-[#322625]">
    <div class="max-w-5xl mx-auto px-4 py-8">
      <h1
        class="text-4xl font-bold bg-gradient-to-r from-[#ff4c00] to-[#ff914d] bg-clip-text text-transparent mb-2"
      >
        Test Result
      </h1>
      <p class="text-[#d1bfbf] text-lg">
        AI-generated Playwright test report preview
      </p>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="flex flex-col items-center justify-center mt-20">
    <div
      class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"
    ></div>
    <p class="mt-4 text-[#d1bfbf]">Running test, please wait...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="text-center mt-10 text-red-600 text-lg">
    {{ errorMessage }}
  </div>

  <!-- Main Content -->
  <div
    *ngIf="!loading && testResult"
    class="max-w-5xl mx-auto px-4 py-8 space-y-8"
  >
    <!-- Summary -->
<!-- Summary -->
<div *ngIf="testResult as result"
  class="bg-gradient-to-br from-[#2b1d1d] via-[#231a1b] to-[#1b1313] border border-[#322625] rounded-2xl shadow p-6"
>
  <div class="flex justify-between items-center">
    <div>
      <h2 class="text-xl text-[#ff4c00] font-semibold">
        {{ result.websiteUrl || 'No Website URL' }}
      </h2>
      <p class="text-sm text-[#d1bfbf] mt-1">
        Executed at {{ result.executionTime | date: 'medium' }}
      </p>
    </div>

    <span
      class="px-3 py-1 text-sm rounded-full font-medium"
      [ngClass]="{
        'bg-green-200 text-green-700': result.status === 'passed',
        'bg-yellow-200 text-yellow-800': result.status === 'processing',
        'bg-red-200 text-red-700': result.status === 'failed'
      }"
    >
      {{ result.status | titlecase }}
    </span>
  </div>

  <div class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-[#d1bfbf]">
    <p><strong>Duration:</strong> {{ result.duration }}</p>
    <p><strong>Browser:</strong> {{ result.browser }}</p>
    <p><strong>Test ID:</strong> {{ result.id }}</p>
  </div>
</div>


    <!-- Logs -->
    <div
      *ngIf="testResult?.logs?.length"
      class="bg-gradient-to-br from-[#2b1d1d] via-[#231a1b] to-[#1b1313] border border-[#322625] rounded-2xl shadow p-6"
    >
      <h3 class="text-lg text-[#d1bfbf] font-semibold mb-4 flex items-center gap-2">
        üñ•Ô∏è Execution Logs
      </h3>
      <div
        class="bg-[#000000] text-gray-100 p-4 font-mono text-sm max-h-64 overflow-y-auto rounded-lg whitespace-pre-wrap"
      >
        <div *ngFor="let log of testResult?.logs">‚Ä¢ {{ log }}</div>
      </div>
    </div>

    <!-- Bugs -->
<div
  *ngIf="testResult?.bugs?.length"
  class="bg-gradient-to-br from-[#2b1d1d] via-[#231a1b] to-[#1b1313] border border-[#322625] rounded-2xl shadow-lg p-6"
>
  <h3 class="text-lg text-[#d1bfbf] font-semibold mb-4 flex items-center gap-2">
    üêû Bugs Detected
  </h3>

  <div class="space-y-4">
    <div
      *ngFor="let bug of testResult?.bugs"
      class="p-4 rounded-lg bg-gradient-to-br from-[#201617] via-[#161010] to-[#171010] border border-red-900 shadow-md "
    >
      <p class="font-semibold text-red-700">{{ bug.title }}</p>
      <p class="text-sm text-red-600 mt-1">{{ bug.description }}</p>
      <span
        class="mt-3 inline-block text-xs px-2 py-1 rounded bg-red-900/40 text-red-200 font-medium border border-red-800/40"
      >
        Severity: {{ bug.severity | titlecase }}
      </span>
    </div>
  </div>
</div>


    <!-- Recommendations -->
    <div
      *ngIf="testResult?.recommendations?.length"
      class="bg-gradient-to-br from-[#2b1d1d] via-[#231a1b] to-[#1b1313] border border-[#322625] rounded-2xl shadow p-6"
    >
      <h3 class="text-lg text-[#d1bfbf] font-semibold mb-4 flex items-center gap-2">
        üí° AI Recommendations
      </h3>
      <div class="space-y-4">
        <div
          *ngFor="let rec of testResult?.recommendations"
          class="p-4 rounded-lg bg-gradient-to-br from-[#201617] via-[#161010] to-[#171010] border border-yellow-900 shadow-md"
        >
          <p class="font-semibold text-yellow-700">{{ rec.title }}</p>
          <p class="text-sm text-yellow-600 mt-1">{{ rec.description }}</p>
          <div class="mt-2 flex gap-2 text-xs">
            <span
              class="px-2 py-1 rounded bg-yellow-200 text-yellow-800 font-medium"
            >
              Impact: {{ rec.impact | titlecase }}
            </span>
            <span
              class="px-2 py-1 rounded bg-blue-200 text-blue-800 font-medium"
            >
              Category: {{ rec.category }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Screenshots -->
    <div
      *ngIf="testResult?.screenshots?.length"
      class="bg-gradient-to-br from-[#2b1d1d] via-[#231a1b] to-[#1b1313] border border-[#322625] rounded-2xl shadow p-6"
    >
      <h3 class="text-lg text-[#d1bfbf] font-semibold mb-4">Screenshots</h3>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
        <div *ngFor="let shot of testResult?.screenshots" class="text-center">
          <img
            [src]="shot.url"
            alt="Test Screenshot"
            class="rounded-lg text-[#d1bfbf] border hover:scale-105 transition-transform duration-200"
          />
          <p class="text-sm text-[#d1bfbf] mt-2">
            {{ shot.caption }}
          </p>
        </div>
      </div>
    </div>

    <!-- Script -->
<div *ngIf="testResult as result">
  <div
    *ngIf="result.script"
    class="bg-gradient-to-br from-[#2b1d1d] via-[#231a1b] to-[#1b1313] border border-[#322625] rounded-2xl shadow p-6"
  >
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg text-[#d1bfbf] font-semibold flex items-center gap-2">
        üìú AI-Generated Script
      </h3>
      <button
        class="flex items-center gap-2 px-3 py-1 rounded text-white transition"
        [ngClass]="copied ? 'bg-green-600 hover:bg-green-700' : 'bg-[#ff4c00] hover:bg-[#ff914d]'"
        (click)="copyScript()"
      >
        {{ copied ? 'Copied!' : 'Copy Script' }}
      </button>
    </div>

    <pre
      class="bg-[#000000] text-green-300 p-4 font-mono text-sm max-h-96 overflow-y-auto rounded-lg whitespace-pre-wrap"
    >
      <code>{{ result.script }}</code>
    </pre>
  </div>
</div>

    <!-- Buttons -->
    <div class="flex justify-end gap-3">
      <button
        (click)="handleRerun()"
        class="flex items-center gap-2 px-3 py-1 rounded bg-[#ff4c00]  text-white hover:bg-[#ff914d] transition"
      >
        Re-run Test
      </button>

      <button
        (click)="handleDownload()"
        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 text-gray-800 hover:bg-gray-300 transition"
      >
        Download Report
      </button>
    </div>
  </div>
</div>
